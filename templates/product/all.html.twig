{% extends 'base.html.twig' %}

{% block title %}Hello ProductController!
{% endblock %}

{% block body %}

	<div class="row justify-content-between">
		<div class="row">
			<div class="m-4 dropdown">
				<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					Categoria
				</button>
				<div class="dropdown-menu " aria-labelledby="dropdownMenuButton">
					{% for value in categorias %}
						<!-- Aca en los href van los FILTROS  -->
						<a class="dropdown-item" href={{ path("allProduct", {idcategoria: value.idcategoria, sort: sort, page: page,search: search} ) }}>{{value.nombrecategoria}}</a>
						{# <a class="dropdown-item" href="all?{{value.idcategoria}} {{filtersort}} {{filterpage}}"> {{value.nombrecategoria}}</a> #}
					{% endfor %}
				</div>
			</div>
			<div class="m-4 dropdown">
				<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					Ordenar Por
				</button>
				<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
					<!-- Aca en los href van los FILTROS  -->
					{# Aca espera qe el ID categoria no sea vacio ! #}
						<a class="dropdown-item" href={{ path("allProduct", {idcategoria: idcategoria, sort: "1", page: page,search: search} ) }}> Mas Reciente</a>
					<a class="dropdown-item" href={{ path("allProduct", {idcategoria: idcategoria, sort: "2", page: page,search: search} ) }}>Mas Antiguo</a>
					<a class="dropdown-item" href={{ path("allProduct", {idcategoria: idcategoria, sort: "3", page: page,search: search} ) }}>Mayor Precio</a>
					<a class="dropdown-item" href={{ path("allProduct", {idcategoria: idcategoria, sort: "4", page: page,search: search} ) }}>Menor Precio</a>
				</div>
			</div>
		</div>
		{% if categoriaunica is not empty %}
			<div>
				<span class="badge badge-info">{{categoriaunica.nombrecategoria}}
				</span>
			</div>
		{% endif %}
		<form action={{ path("allProduct", {idcategoria: idcategoria, sort: sort, page: page,search: search} ) }} method="GET">
			<div class="input-group col-xl-11 m-3 aling-self-start">
				<div class="input-group-prepend">
					<button class="btn btn-outline-secondary" type="submit" id="button-addon1">Buscar</button>
				</div>
				<input type="text" id="search" name="search" class="form-control col" placeholder="" aria-label="Example text with button addon" aria-describedby="button-addon1">
			</div>
		</form>
	</div>


	<div class="container">
		<div class="row">
			{% for value in dataproductforrender %}
				<div class="col-xl-4 col-lg-6 col-md-6 col-sm-12 pr-4 pb-4">
					<div class="card-deck">
						<div class="mt1 card">
							<img src="{{value.url}}" class="card-img-top" alt="FotosMaquinas">
							<div class="card-body">
								<h5 class="card-title">{{value.nombre}}</h5>
								<p class="card-text">{{value.descripcion}}</p>
								<p class="card-text">Precio ${{value.precio}}</p>
								<a href="/product/detail&idproduct={{value.idproduct}}" class="btn btn-primary">Ver Mas</a>
							</div>
						</div>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>

	{% if numPaginas != "0" %}
		<nav aria-label="Page navigation example" class="m-5">
			<ul
				class="pagination">
				<!-- Aca en los href van los FILTROS  -->
				<li class="page-item">
					<a class="page-link" href={{ path("allProduct", {idcategoria: idcategoria, sort: sort, page: prev,search: search} ) }}>Anterior</a>
				</li>
				{# {{numPaginas}} #}
				{% for i in 1..numPaginas %}
					{% set active = "" %}
					{% if page==i %}
						{% set active = "active" %}
					{% endif %}
					<li class="page-item {{active}}">
						<a class="page-link" href={{ path("allProduct", {idcategoria: idcategoria, sort: sort, page: i,search: search} ) }}>
							{{i}}
						</a>
					</li>
				{% endfor %}
				<li class="page-item">
					<a class="page-link" href={{ path("allProduct", {idcategoria: idcategoria, sort: sort, page: next,search: search} ) }}>Siguiente</a>
				</li>
			</ul>
		</nav>
	{% else %}
		<div class="alert alert-info" role="alert">
			Proximamente habra productos en esta categoria, Gracias !
		</div>
	{% endif %}
{% endblock %}
